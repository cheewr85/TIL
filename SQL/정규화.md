### 데이터베이스 이상 현상
- 이상 현상(anomaly), 주어진 데이터베이스에서 삽입, 업데이트, 삭제를 제대로 할 수 없게 되는 경우임
- 삽입 이상, 새로운 데이터를 자연스럽게 저장할 수 없는 경우
- 업데이트 이상, 데이터를 업데이트했을 때, 정확성을 지키기 어려워지는 경우
- 삭제 이상, 원하는 데이터만 자연스럽게 삭제할 수 없는 경우
- 데이터 모델링을 제대로 하지 않았기 때문에 발생

### 정규화
- 데이터베이스 구조가 복잡해질수록 판단이 점점 어려워짐
- 정규화는 데이터베이스의 테이블이 잘 만들어졌는지 평가하고, 잘 만들지 못한 테이블을 고쳐나가는 과정임
- 테이블을 정규형(normal form)이라고 불리는 형태에 부합하게 만들어나감
- 정규형(Normal Form)은 지켜야되는 순서에 따라 NF와 숫자를 사용해서 표기함, 순서에 따라 규칙이 누적됨

![picture](/img/SQL/Regular/one.png)

- 대부분 제3정규형에만 부합해도 좋은 데이터베이스라고 함
- 정규화를 잘하면 이상현상을 없앨 수 있고 새로운 종류의 데이터를 추가할 때 테이블 구조 수정을 많이 하지 않아도 되고 구조를 단순화해서 사용자가 더 쉽게 이해할 수 있음
- 정규화는 데이터 모델을 만들고, 데이터베이스에 구현하기 전에 적용하면 좋음

### 1NF(제1정규형)
- 테이블 안 모든 로우의 모든 컬럼 값들을 나눌 수 없는 단일값이어야 함
- 1NF를 지키지 않는 경우
- 한 컬럼에 같은 종류의 값을 여러 개 저장하고 있을 때 → 이때는 해당 컬럼을 하나의 테이블로 분리해서 모델링함
- 한 컬럼에 서로 다른 종류의 값을 여러 개 저장하고 있을 때 → 이때는 한 컬럼을 여러 개로 분리해서 모델링함

### 함수 종속성
- Functional Dependency
- x의 값에 따라서 y의 값이 결정될 때, y는 x에 함수 종속성이 있다고 함, x → y
- 수학에서 함수와 같은 관계를 생각할 수 있음
- 아래와 같은 관계를 가지고 테이블에서도 함수 종속성이 있다고 볼 수 있음

![picture](/img/SQL/Regular/two.png)

- 그렇다고 name, age, gender에 따라 나머지 값이 결정되지는 않음
- 아래와 같은 관계도 형성될 수 있음

![picture](/img/SQL/Regular/three.png)

- 함수 종속성에는 이행성이라는 속성이 있음
- attribute 사이의 관계가 살짝 다른 경우가 있음, 예를 들어 제품에 대해서 보면 product → brand → brand_country
- 이처럼 하나 이상의 attribute를 건너서 함수 종속성이 있는 경우에 함수 종속성이 넘어갔다, 이행됐다고 함 여기서 brand_country가 product에 대한 이행적 함수 종속성이 있다고 함

### Candidate Key
- 하나의 row를 특정 지을 수 있는 attribute들의 최소 집합
- 여러 개의 candidate key가 존재할 수 있음, 하나의 row들을 특정 지을 수 있는 것을 의미함
- candidate key에 포함된 모든 attribute는 prime attribute라고 부름, 이에 속하지 않은 것은 non-prime attribute라고 함

### 2NF(제2정규형)
- 1NF에 부합해야함(테이블 안 모든 값이 나눌 수 없는 단일 값이어야 함)
- 테이블에 candidate key의 일부분에 대해서만 함수 종속성이 있는 non-prime attribute가 없어야 함
- non-prime attribute를 분리해주면 됨

### 3NF(제3정규형)
- 2NF에 부합해야함
- 테이블 안에 있는 모든 attribute들은 오직 primary key에 대해서만 함수 종속성이 있어야 함(테이블의 모든 attribute는 직접적으로 테이블 Entity에 대한 내용이어야만 함)
- 이행적 함수 종속성도 있으면 안됨

### 비정규화
- 정규화를 지키기 위해서는 하나의 테이블을 여러개 나눔, 하지만 너무 많이 데이터가 퍼져 있거나 다시 모을 때 속도가 느려질 수 있음, 이를 해결하기 위해서 비정규화를 하여 이런 정보들은 한 테이블에 저장할 수 있기 때문에 조금 더 빠르게 조회하는 성능개선이 가능함
- 하지만 비정규화를 무조건 하는 것은 아니고 아래와 같은 조건을 충족했을 때 주로함
- 데이터가 너무 퍼져있어서 조회 성능 문제가 심각한 수준으로 일어나는 게 확실하고
- 테이블을 삽입, 업데이트, 삭제하는 것보다 조회하는 용도로만 사용하고 있을 때 함

